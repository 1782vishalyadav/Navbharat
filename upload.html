<!DOCTYPE html>
<html>
<head>
  <title>Secure Upload</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="upload.css" />
</head>
<body>
  <header>
    <div class="top-bar">
      <span class="date" id="currentDate"></span>
      <span class="tagline">‡§®‡§µ‡•Ä‡§® ‡§µ‡§ø‡§ö‡§æ‡§∞...‡§®‡§µ‡•ç‡§Ø‡§æ ‡§¶‡§ø‡§∂‡§æ! ‡§µ‡§ø‡§∂‡•á‡§∑ ‡§¨‡§æ‡§§‡§Æ‡•Ä | ‡§µ‡§ø‡§∂‡•ç‡§µ‡§æ‡§∏‡§æ‡§∞‡•ç‡§π ‡§∏‡•ç‡§∞‡•ã‡§§ | ‡§∏‡•ç‡§™‡§∑‡•ç‡§ü ‡§Æ‡§§‡•á</span>
      <span class="social-icons">
        <a href="#" title="Twitter" aria-label="Twitter">
          <!-- Twitter SVG -->
          <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor" style="vertical-align:middle;"><path d="M22.46 5.924c-.793.352-1.645.59-2.54.698a4.48 4.48 0 0 0 1.963-2.475 8.94 8.94 0 0 1-2.828 1.082 4.48 4.48 0 0 0-7.635 4.086A12.72 12.72 0 0 1 3.112 4.89a4.48 4.48 0 0 0 1.388 5.976 4.44 4.44 0 0 1-2.03-.561v.057a4.48 4.48 0 0 0 3.594 4.393 4.48 4.48 0 0 1-2.025.077 4.48 4.48 0 0 0 4.184 3.11A8.98 8.98 0 0 1 2 19.54a12.67 12.67 0 0 0 6.88 2.017c8.26 0 12.78-6.84 12.78-12.78 0-.195-.004-.39-.013-.583a9.13 9.13 0 0 0 2.24-2.33z"/></svg>
        </a>
        <a href="#" title="Facebook" aria-label="Facebook">
          <!-- Facebook SVG -->
          <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor" style="vertical-align:middle;"><path d="M22.675 0h-21.35C.595 0 0 .592 0 1.326v21.348C0 23.408.595 24 1.325 24H12.82v-9.294H9.692v-3.622h3.127V8.413c0-3.1 1.893-4.788 4.659-4.788 1.325 0 2.463.099 2.797.143v3.24l-1.918.001c-1.504 0-1.797.715-1.797 1.763v2.313h3.587l-.467 3.622h-3.12V24h6.116c.73 0 1.325-.592 1.325-1.326V1.326C24 .592 23.405 0 22.675 0"/></svg>
        </a>
        <a href="#" title="Instagram" aria-label="Instagram">
          <!-- Instagram SVG -->
          <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor" style="vertical-align:middle;"><path d="M12 2.163c3.204 0 3.584.012 4.85.07 1.366.062 2.633.334 3.608 1.308.974.974 1.246 2.242 1.308 3.608.058 1.266.07 1.646.07 4.85s-.012 3.584-.07 4.85c-.062 1.366-.334 2.633-1.308 3.608-.974.974-2.242 1.246-3.608 1.308-1.266.058-1.646.07-4.85.07s-3.584-.012-4.85-.07c-1.366-.062-2.633-.334-3.608-1.308-.974-.974-1.246-2.242-1.308-3.608C2.175 15.647 2.163 15.267 2.163 12s.012-3.584.07-4.85c.062-1.366.334-2.633 1.308-3.608.974-.974 2.242-1.246 3.608-1.308C8.416 2.175 8.796 2.163 12 2.163zm0-2.163C8.741 0 8.332.013 7.052.072 5.775.131 4.602.388 3.635 1.355 2.668 2.322 2.411 3.495 2.352 4.772.013 8.332 0 8.741 0 12c0 3.259.013 3.668.072 4.948.059 1.277.316 2.45 1.283 3.417.967.967 2.14 1.224 3.417 1.283C8.332 23.987 8.741 24 12 24c3.259 0 3.668-.013 4.948-.072 1.277-.059 2.45-.316 3.417-1.283.967-.967 1.224-2.14 1.283-3.417.059-1.28.072-1.689.072-4.948 0-3.259-.013-3.668-.072-4.948-.059-1.277-.316-2.45-1.283-3.417-.967-.967-2.14-1.224-3.417-1.283C15.668.013 15.259 0 12 0zm0 5.838a6.162 6.162 0 1 0 0 12.324 6.162 6.162 0 0 0 0-12.324zm0 10.162a3.999 3.999 0 1 1 0-7.998 3.999 3.999 0 0 1 0 7.998zm6.406-11.845a1.44 1.44 0 1 0 0 2.88 1.44 1.44 0 0 0 0-2.88z"/></svg>
        </a>
      </span>
    </div>
    <div class="logo">üì∞ ‡§®‡§µ ‡§¶‡•É‡§∑‡•ç‡§ü‡§ø‡§ï‡•ã‡§®</div>
    <nav>
      <a href="index.html">Home</a>
      <a href="archive.html">Archive</a>
      <a href="upload.html" class="active">Admin</a>
    </nav>
  </header>

  <main>
    <div class="container" id="login-container">
      <h2>Admin Login</h2>
      <input type="email" id="email" placeholder="Email" />
      <input type="password" id="password" placeholder="Password" />
      <button onclick="signIn()">Login</button>
      <p id="login-status"></p>
    </div>

    <div class="container" id="upload-container" style="display:none;">
      <h2>Upload New PDF</h2>
      <input type="file" id="pdfFile" accept="application/pdf" />
      <button onclick="uploadPDF()">Upload</button>
      <p id="status"></p>
      <button onclick="signOut()">Logout</button>
      <a href="index.html">View PDF</a>
    </div>
  </main>

  <footer>
    <div class="footer-content">
      <span>&copy; 2025 ‡§®‡§µ ‡§¶‡•É‡§∑‡•ç‡§ü‡§ø‡§ï‡•ã‡§® | All Rights Reserved.</span>
      <span>Contact: info@navdrishtikon.com | ‡§∏‡§Ç‡§™‡§æ‡§¶‡§ï: ‡§µ‡§ø‡§∑‡•ç‡§£‡•Ç ‡§Æ‡•ã‡§∞‡•á</span>
       <span>Developer: Vishal Yadav</span>
    </div>
  </footer>

  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>
  <script>
    // Date display
    document.addEventListener('DOMContentLoaded', function () {
      document.getElementById('currentDate').textContent = new Date().toLocaleDateString('en-IN', {
        year: 'numeric', month: 'long', day: 'numeric', weekday: 'long'
      });

      // Initialize Supabase client
      window.supabase = supabase.createClient(
        'https://jcvjjnxvjyhwkyttncqw.supabase.co',
        'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Impjdmpqbnh2anlod2t5dHRuY3F3Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTIzOTA2ODMsImV4cCI6MjA2Nzk2NjY4M30.aNsZLlMts4DQxBAkqXkLi0imYUEMr0OPr9vpGxdYQ70'
      );

      // Auto-check login on page load
      supabase.auth.getUser().then(({ data }) => {
        if (data && data.user) {
          document.getElementById('login-container').style.display = 'none';
          document.getElementById('upload-container').style.display = 'block';
        }
      });
    });

    async function signIn() {
      const email = document.getElementById('email').value;
      const password = document.getElementById('password').value;
      document.getElementById('login-status').textContent = "Logging in...";
      const { data, error } = await supabase.auth.signInWithPassword({ email, password });

      if (error) {
        document.getElementById('login-status').textContent = "‚ùå Login failed: " + error.message;
      } else if (data && data.user) {
        document.getElementById('login-status').textContent = "";
        document.getElementById('login-container').style.display = 'none';
        document.getElementById('upload-container').style.display = 'block';
      } else {
        document.getElementById('login-status').textContent = "‚ùå Login failed: Unknown error.";
      }
    }

    async function signOut() {
      await supabase.auth.signOut();
      document.getElementById('upload-container').style.display = 'none';
      document.getElementById('login-container').style.display = 'block';
      document.getElementById('login-status').textContent = "";
      document.getElementById('status').textContent = "";
      document.getElementById('email').value = "";
      document.getElementById('password').value = "";
    }

    async function uploadPDF() {
      const { data: userData } = await supabase.auth.getUser();
      if (!userData || !userData.user) {
        document.getElementById('status').textContent = "‚ùå Not authorized. Please login again.";
        return;
      }

      const file = document.getElementById('pdfFile').files[0];
      if (!file) {
        document.getElementById('status').textContent = "‚ùå Please select a PDF file.";
        return;
      }
      document.getElementById('status').textContent = "Uploading...";
      console.log("Uploading file:", file);

      const { data, error } = await supabase.storage.from('pdf').upload('latest.pdf', file, { upsert: true });
      console.log("Upload result:", data, error);

      document.getElementById('status').textContent = error
        ? "‚ùå Upload failed: " + error.message
        : "‚úÖ Upload successful!";
    }
  </script>
</body>
</html>
